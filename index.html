<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zootropo Interactivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        #zootrope-image {
            max-width: 90vw;
            max-height: 70vh;
            /* Se ha eliminado la transición para evitar conflictos con la animación de giro */
        }
        .rotate {
            /* La animación usa una variable CSS para la velocidad */
            animation: spin var(--spin-speed) linear infinite;
        }
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container">
        <div class="bg-white rounded-xl shadow-lg p-8 max-w-lg w-full flex flex-col items-center text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Zootropo Interactivo</h1>
            <p class="text-gray-600 mb-6">
                Sube una imagen circular con tu animación y presiona "Girar" para ver la magia del zootropo.
            </p>

            <!-- Contenedor para la entrada de archivo -->
            <div class="mb-6 w-full">
                <label class="block mb-2 text-sm font-medium text-gray-700">
                    Selecciona tu disco de zootropo:
                </label>
                <input type="file" id="image-upload" accept="image/*" class="w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-full file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-50 file:text-blue-700
                    hover:file:bg-blue-100 cursor-pointer" />
            </div>

            <!-- Contenedor de la imagen del zootropo -->
            <div class="w-full flex justify-center items-center mb-6">
                <!-- Se inicializa la variable CSS para la velocidad de giro -->
                <img id="zootrope-image" src="https://placehold.co/400x400/e2e8f0/64748b?text=Subir+Imagen" alt="Disco de Zootropo" class="rounded-full shadow-md" style="--spin-speed: 1s;" />
            </div>

            <!-- Contenedor de los botones de control -->
            <div class="flex flex-wrap justify-center space-x-2 md:space-x-4">
                <button id="spin-btn" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-full shadow-md hover:bg-blue-700 transition duration-300 mb-2">
                    Girar
                </button>
                <button id="stop-btn" class="bg-red-500 text-white font-semibold py-2 px-6 rounded-full shadow-md hover:bg-red-600 transition duration-300 mb-2">
                    Detener
                </button>
                <button id="increase-speed-btn" class="bg-green-500 text-white font-semibold py-2 px-6 rounded-full shadow-md hover:bg-green-600 transition duration-300 mb-2">
                    Aumentar Velocidad
                </button>
                <button id="decrease-speed-btn" class="bg-yellow-500 text-white font-semibold py-2 px-6 rounded-full shadow-md hover:bg-yellow-600 transition duration-300 mb-2">
                    Disminuir Velocidad
                </button>
            </div>
            
            <!-- Contador de velocidad -->
            <div class="mt-4 text-center">
                <p class="text-gray-700 font-medium">Velocidad: <span id="speed-counter" class="font-bold">1.0s</span></p>
            </div>
        </div>
    </div>

    <script>
        // Obtener referencias a los elementos del DOM
        const imageUpload = document.getElementById('image-upload');
        const zootropeImage = document.getElementById('zootrope-image');
        const spinBtn = document.getElementById('spin-btn');
        const stopBtn = document.getElementById('stop-btn');
        const increaseSpeedBtn = document.getElementById('increase-speed-btn');
        const decreaseSpeedBtn = document.getElementById('decrease-speed-btn');
        const speedCounter = document.getElementById('speed-counter'); // Nuevo elemento del contador

        let rotationInterval;
        let currentSpeed = 1.0; // Velocidad inicial en segundos por giro

        // Manejar el evento de cambio en la entrada de archivo
        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    zootropeImage.src = event.target.result;
                    // Detener cualquier animación en curso al cargar una nueva imagen
                    stopAnimation();
                };
                reader.readAsDataURL(file);
            }
        });

        // Función para iniciar la animación de giro
        const startAnimation = () => {
            zootropeImage.classList.add('rotate');
        };

        // Función para detener la animación
        const stopAnimation = () => {
            zootropeImage.classList.remove('rotate');
        };

        // Función para actualizar la velocidad de la animación y el contador
        const updateSpeed = () => {
            // Actualizar la variable CSS
            zootropeImage.style.setProperty('--spin-speed', `${currentSpeed}s`);
            // Actualizar el texto del contador
            speedCounter.textContent = `${currentSpeed.toFixed(1)}s`;
        };

        // Aumentar la velocidad (disminuir el valor en segundos)
        increaseSpeedBtn.addEventListener('click', () => {
            // Asegurarse de que no sea demasiado rápido
            if (currentSpeed > 0.1) {
                currentSpeed -= 0.1;
                updateSpeed();
            }
        });

        // Disminuir la velocidad (aumentar el valor en segundos)
        decreaseSpeedBtn.addEventListener('click', () => {
            // Asegurarse de que no sea demasiado lento
            if (currentSpeed < 5) {
                currentSpeed += 0.1;
                updateSpeed();
            }
        });

        // Escuchar los clics en los botones de control
        spinBtn.addEventListener('click', startAnimation);
        stopBtn.addEventListener('click', stopAnimation);

    </script>
</body>
</html>